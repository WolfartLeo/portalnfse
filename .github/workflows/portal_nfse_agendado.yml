name: Rodar PortalNFSe (agendado)

on:
  workflow_dispatch:
  schedule:
    # Dia 5 às 08:00 (UTC) => 05:00 em São Paulo (UTC-3). Ajuste conforme sua rotina.
    - cron: "0 8 5 * *"

jobs:
  run:
    runs-on: ubuntu-latest
    timeout-minutes: 360
    steps:
      - uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run bot (HEADLESS)
        env:
          HEADLESS: "1"
          TZ: "America/Sao_Paulo"
        run: |
          # IMPORTANT:
          # - Este workflow só vai funcionar se o arquivo da planilha de clientes estiver disponível no repo
          #   OU se você criar um passo aqui para baixar/gerar esse arquivo a partir de Secrets.
          python bot_nfse.py

      - name: Upload outputs (saidas/)
        uses: actions/upload-artifact@v4
        with:
          name: saidas
          path: saidas/
